### 题目：
# Лабораторная работа №6.  
**Обмен данными с ВУ по прерыванию**  
**通过中断与外部设备进行数据交换**  

Цель работы - изучение организации процесса прерывания программы и исследования порядка функционирования ЭВМ при обмене данными в режиме прерывания программы.  
工作的目的是研究程序中断过程的组织，以及在程序中断模式下计算机数据交换时的运行顺序。  
Задание. По выданному преподавателем варианту разработать и исследовать работу комплекса программ обмена данными в режиме прерывания программы. Основная программа должна изменять содержимое заданной ячейки памяти (X), которое должно быть представлено как знаковое число. Область допустимых значений изменения X должна быть ограничена заданной функцией F(X) и конструктивными особенностями регистра данных BY (8-ми битное знаковое представление). Программа обработки прерываний должна *мооцидировать* ячейку памяти для хранения X в соответствии с вариантом задания и выводить его на BY, а также игнорировать все необрабатываемые прерывания.  
任务。根据教师提供的选项，开发并研究在程序中断模式下数据交换程序复合体的工作。主程序应更改指定内存单元（X）的内容，该内容应表示为有符号数。X的变化范围应受限于给定函数F(X)和数据寄存器BY的结构特性（8位有符号表示）。中断处理程序应根据任务选项*修改*存储X的内存单元，并将其输出到BY，同时忽略所有不可处理的中断。  

Подготовка к выполнению работы  
Изучить организацию в базовой ЭВМ программно-управляемого обмена данными в режиме прерывания программы (Приложение B, п.2.4, пример 4). Разработать комплекс программ, указанный в задании. Составить методику проверки правильности выполнения разработанного комплекса программ на БЭВМ, т.е. написать последовательность действий оператора (пользователя) БЭВМ, которые необходимо выполнить, чтобы проверить все возможные режимы работы комплекса программ (при появлении запроса прерывания от любого BY) и получить заданное  
准备工作  
研究基础计算机中程序中断模式下软件控制数据交换的组织（附录B，第2.4节，示例4）。开发任务中指定的程序复合体。制定在基础计算机上验证所开发程序复合体正确性的方法，即编写操作员（用户）需要执行的操作序列，以检查程序复合体在所有可能的工作模式下（当任何BY发出中断请求时）的运行情况，并获取指定的  

количество результатов. Пример методики см. в разделе содержание отчета.

Порядок выполнения работы.
1. Получить допуск к лабораторной работе, предъявив преподавателю подготовленные материалы.
2. Занести разработанный комплекс программ в память БЭВМ.
3. В присутствии преподавателя провести проверку работоспособности комплекса программ в автоматическом режиме.
4. Используя методику проверки разработанного комплекса программ, получить 3 пары результатов, указывая для каждого выведенного значения величину X.
5. Результаты работы программного комплекса представить в виде таблицы результатов работы комплекса.

数量的结果。方法示例见报告内容部分。  
工作执行顺序。  
1. 向教师提交准备好的材料，获得实验许可。
2. 将开发的程序复合体加载到基础计算机的内存中。
3. 在教师在场的情况下，以自动模式检查程序复合体的运行情况。
4. 使用验证程序复合体的方法，获取3对结果，并为每个输出值指明X的大小。
5. 将程序复合体的工作结果以表格形式呈现。

Содержание отчета по работе. В дополнение к общим обязательным требованиям, отчет должен содержать:

1. Описание программы, аналогично п.2 требований к отчету для ЛР№2.
2. Текст исходной программы на языке Ассемблера БЭВМ (синтаксис и особенности приведены в Приложении Д).
3. Полностью разработанную и проверенную на БЭВМ методику проверки.

Пример. Начальный фрагмент методики проверки.

1. Загрузить комплекс программ в память базовой ЭВМ.
2. Изменить значения точки останова по адресу … на НLT
3. Запустить основную программу в автоматическом режиме с адреса …
4. Установить "Готовность BY-3".
5. Дождаться останова
6. Записать содержимое аккумулятора в момент останова программы
7. Продолжить выполнение программы
8. …

工作报告内容。除一般强制性要求外，报告还应包含：
1. 程序描述，类似于实验报告第2号的要求第2点。
2. 基础计算机汇编语言的源代码（语法和特点见附录Д）。
3. 完整开发并在基础计算机上验证的检查方法。

示例。检查方法的初始片段。

1. 将程序复合体加载到基础计算机的内存中。
2. 将地址…处的断点值更改为HLT。
3. 从地址…以自动模式启动主程序。
4. 设置“BY-3准备就绪”。
5. 等待程序停止。
6. 记录程序停止时累加器的内容。
7. 继续执行程序。
8. …

--------------------------------------

1. Особенности организации программ обмена данными с использованием прерываний. Сохранение и восстановление значений регистров.

2. Команды работы разрешения/запрещения прерываний БЭВМ, команда программного прерывания, команда возврата из прерывания. Название, назначение и тип команды. Количество и название машинных циклов, потактовое выполнение команды.

3. Вектора прерываний. Преимущества использования векторов прерываний.

4. Регистр управления BY (MR DEV).

5. Сигналы шины БЭВМ, назначение, временные диаграммы сигналов Input и Output.

6. Когда выполняется цикл обработки прерывания? После каких команд он не выполняется? Почему?

7. Обрабатываются ли прерывания в пошаговом режиме (режиме "ОСТАНОВ") работы программы? Почему?

8. Что происходит при одновременном поступлении сигнала готовности нескольких внешних устройств? В какой последовательности они будут обработаны?

9. За что отвечают биты 5, 6, 7 и 8 регистра состояния? Когда изменяется их значение?

---------------------------------------

1. 使用中断的数据交换程序的组织特点。寄存器值的保存和恢复。

2. 基础计算机的中断允许/禁止命令、软件中断命令、中断返回命令。名称、用途和命令类型。机器周期的数量和名称，命令的逐步执行。

3. 中断向量。使用中断向量的优势。

4. BY控制寄存器（MR DEV）。

5. 基础计算机总线信号，用途，Input和Output信号的时间图。

6. 中断处理周期何时执行？在哪些命令之后不会执行？为什么？

7. 在程序的逐步模式（“停止”模式）下是否会处理中断？为什么？

8. 当多个外部设备同时发出就绪信号时会发生什么？它们将按什么顺序被处理？

9. 状态寄存器的第5、6、7和8位负责什么？它们的值何时改变？


### Введите номер варианта [10746] / 输入选项编号 [10746]:

Основная программа должна увеличивать на 2 содержимое X (ячейки памяти с адресом  ${023}_{16}$  ) в цикле.
主程序应在循环中将X（内存地址  ${023}_{16}$  ）的内容每次增加2。

Обработчик прерывания должен:
中断处理程序应：

по нажатию кнопки готовности BY-3 осуществлять вывод результата вычисления функции F(X)=3X+5 на данное BY;
当按下ВУ-3的准备就绪按钮时，将函数F(X)=3X+5的计算结果输出到该ВУ；

по нажатию кнопки готовности BY-2 выполнить операцию побитового маскирования, оставив 5-х младших разряда содержимого PI данного BY и X, результат записать в X.
当按下ВУ-2的准备就绪按钮时，执行位掩码操作，保留该ВУ的数据寄存器（PI）和X的低5位，并将结果写入X。

Если X оказывается вне ОДЗ при выполнении любой операции по его изменению, то необходимо в X записать минимальное по ОДЗ число.
如果在执行任何修改X的操作时，X超出允许范围（ОДЗ），则应将X设置为允许范围内的最小值。


По выданному преподавателем варианту разработать и исследовать работу комплекса программ обмена данными в режиме прерывания программы. Основная программа должна изменять содержимое заданной ячейки памяти (Х), которое должно быть представлено как знаковое число. Область допустимых значений изменения Х должна быть ограничена заданной функцией F(X) и конструктивными особенностями регистра данных ВУ (8-ми битное знаковое представление). Программа обработки прерывания должна выводить на ВУ модифицированное значение Х в соответствии с вариантом задания, а также игнорировать все необрабатываемые прерывания.
1.	Основная программа должна увеличивать на 2 содержимое X (ячейки памяти с адресом 01216) в цикле.
2.	Обработчик прерывания должен по нажатию кнопки готовности ВУ-1 осуществлять вывод результата вычисления функции F(X)=5X+2 на данное ВУ, a по нажатию кнопки готовности ВУ-2 вычесть Х из содержимого РД данного ВУ, результат записать в Х
3.	Если Х оказывается вне ОДЗ при выполнении любой операции по его изменению, то необходимо в Х записать минимальное по ОДЗ число.

; 任务要求 / Требования задания:
; 1. 主程序：循环将X减2 / Основная программа: уменьшать X на 2 в цикле  
; 2. ВУ-3中断：计算F(X)=-4X-8并输出 / Прерывание ВУ-3: вычислить F(X)=-4X-8 и вывести
; 3. ВУ-2中断：位掩码操作，保留低4位 / Прерывание ВУ-2: маскирование младших 4 битов
; 4. 边界检查：X超出范围时设为最大值 / Проверка границ: при выходе X за диапазон устанавливать максимум


阶段1：ВУ-1中断测试（F(X)=-4X-8）
步骤1-3：程序准备

加载程序到БЭВМ
在int1处理程序的OUT 0x2后插入HLT
启动程序（режим РАБОТА）

步骤4-8：执行测试
4. 手动设置X=10（地址0x008写入0x0A）
5. 按下"ВУ-1 готовность"按钮
6. 等待HLT停止
7. 读取ВУ-1的DR（地址0x2）：期望值0xB8(-72)
8. 验证X值未改变（仍为10）
步骤9-12：多组测试
9. 重复测试X=5，期望DR=0xE4(-28)
10. 重复测试X=-5，期望DR=0x0C(12)
11. 记录所有结果
12. 移除HLT，继续下个测试
阶段2：ВУ-2中断测试（DR-X→X）
步骤13-16：准备测试
13. 在int2处理程序的第二个EI前插入HLT
14. 设置X=10（0x0A）
15. 在ВУ-2数据寄存器写入15（0x0F）
16. 按下"ВУ-2 готовность"
步骤17-20：验证结果
17. 等待停止，读取新X值
18. 期望：X = 15-10 = 5（0x05）
19. 重复测试边界情况：X=5, DR=50 → X应变为30(最大值)
20. 记录所有测试结果
阶段3：主程序循环测试
步骤21-24：边界测试
21. 设置X=30，运行几步主程序
22. 验证：30→28→26→24...（正常递减）
23. 设置X=-32，运行一步
24. 验证：-32→(-34)→30（超界重置）

